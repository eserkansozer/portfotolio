@using Portfotolio.Domain
@using Portfotolio.Site4.Extensions

@model DomainPhoto
@{
    const float fixedHeight = 400;
    var ratio = (float)Model.Medium640Height / (float)Model.Medium640Width;
    var verticalShrinkRatio = fixedHeight/(float) Model.Medium640Height;
    if (ratio > 2 || ratio < 0.5) //exceptional ratio
    {
        return;
    }
    var isVertical = ratio > 1;
    var alignedWidth = isVertical ? Model.Medium640Width/ratio : Model.Medium640Width * verticalShrinkRatio;

}

<div class="slide" style="width: @(alignedWidth +6)px; height:@(fixedHeight+6)px">
    <div class="photo-frame">
        @if (Model.IsLicensed || Html.AuthenticationInfo().IsAuthenticated)
        {
            <a class="photo-link" 
               href="@Model.PageUrl" 
               style="background: url('@Model.Medium640Url'); background-size: @(alignedWidth)px @(fixedHeight)px; width: @(alignedWidth)px; height:@(fixedHeight)px" ></a>
        }
        else
        {
            <a class="photo-link" 
                href="@Model.PageUrl" 
                style="width: @(Model.Medium640Width)px; height: @(Model.Medium640Height)px;">
            </a>
            <a href="@Url.Action("licensing", "settings")" class="copyright" style="top: @(fixedHeight-50)px; left: @(alignedWidth-40)px" title="Copyrighted image. Click for more information.">&copy;</a>
        }
        <div class="title-frame" style="top:@(fixedHeight-20)px; display: none">
            @(Html.ActionLinkUserId(Model.AuthorName ?? Model.AuthorAlias, "photos", new { id = Model.AuthorAlias })):
            <span class="title-text" title="@Model.Title">
                @Model.Title
            </span>
        </div>
    </div>
</div>

<script>
    $(document).ready(function () {
        $(".photo-frame").hover(function () {
            $(".title-frame").css("display", "block");
        }, function () {
            $(".title-frame").css("display", "none");
        });
    });

</script>